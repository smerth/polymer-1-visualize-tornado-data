function createCanvasLayer(){function e(t){function i(e,t){return function(){t.apply(e)}}this.isAdded_=!1,this.paneName_=e.DEFAULT_PANE_NAME_,this.updateHandler_=null,this.resizeHandler_=null,this.topLeft_=null,this.centerListener_=null,this.resizeListener_=null,this.needsResize_=!0,this.requestAnimationFrameId_=null;var s=document.createElement("canvas");s.style.position="absolute",s.style.top=0,s.style.left=0,s.style.pointerEvents="none",this.canvas=s,this.canvasCssWidth_=300,this.canvasCssHeight_=150,this.resolutionScale_=1,this.repositionFunction_=i(this,function(){this.repositionCanvas_(),this.update_()}),this.resizeFunction_=i(this,this.resize_),this.requestUpdateFunction_=i(this,this.update_),t&&this.setOptions(t)}return e.prototype=new google.maps.OverlayView,e.DEFAULT_PANE_NAME_="overlayLayer",e.CSS_TRANSFORM_=function(){for(var e=document.createElement("div"),t=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],i=0;i<t.length;i++){var s=t[i];if(void 0!==e.style[s])return s}return t[0]}(),e.prototype.requestAnimFrame_=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},e.prototype.cancelAnimFrame_=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(e){},e.prototype.setOptions=function(e){void 0!==e.paneName&&this.setPane(e.paneName),void 0!==e.updateHandler&&this.setUpdateHandler(e.updateHandler),void 0!==e.resizeHandler&&this.setResizeHandler(e.resizeHandler),void 0!==e.resolutionScale&&this.setResolutionScale(e.resolutionScale),void 0!==e.map&&this.setMap(e.map)},e.prototype.setPaneName=function(e){this.paneName_=e,this.setPane_()},e.prototype.getPaneName=function(){return this.paneName_},e.prototype.setPane_=function(){if(this.isAdded_){var e=this.getPanes();if(!e[this.paneName_])throw new Error('"'+this.paneName_+'" is not a valid MapPane name.');e[this.paneName_].appendChild(this.canvas)}},e.prototype.setResizeHandler=function(e){this.resizeHandler_=e},e.prototype.setResolutionScale=function(e){"number"==typeof e&&(this.resolutionScale_=e,this.resize_())},e.prototype.setUpdateHandler=function(e){this.updateHandler_=e},e.prototype.onAdd=function(){this.isAdded_||(this.isAdded_=!0,this.setPane_(),this.resizeListener_=google.maps.event.addListener(this.getMap(),"resize",this.resizeFunction_),this.centerListener_=google.maps.event.addListener(this.getMap(),"center_changed",this.repositionFunction_),this.resize_(),this.repositionCanvas_(),this.scheduleUpdate())},e.prototype.onRemove=function(){this.isAdded_&&(this.isAdded_=!1,this.topLeft_=null,this.canvas.parentElement.removeChild(this.canvas),this.centerListener_&&(google.maps.event.removeListener(this.centerListener_),this.centerListener_=null),this.resizeListener_&&(google.maps.event.removeListener(this.resizeListener_),this.resizeListener_=null),this.requestAnimationFrameId_&&(this.cancelAnimFrame_.call(window,this.requestAnimationFrameId_),this.requestAnimationFrameId_=null))},e.prototype.resize_=function(){if(this.isAdded_){var e=this.getMap(),t=e.getDiv().offsetWidth,i=e.getDiv().offsetHeight,s=t*this.resolutionScale_,n=i*this.resolutionScale_,a=this.canvas.width,o=this.canvas.height;a===s&&o===n||(this.canvas.width=s,this.canvas.height=n,this.needsResize_=!0,this.scheduleUpdate()),this.canvasCssWidth_===t&&this.canvasCssHeight_===i||(this.canvasCssWidth_=t,this.canvasCssHeight_=i,this.canvas.style.width=t+"px",this.canvas.style.height=i+"px")}},e.prototype.draw=function(){this.repositionCanvas_(),this.scheduleUpdate()},e.prototype.repositionCanvas_=function(){var t=this.getMap(),i=t.getBounds().getNorthEast().lat(),s=t.getCenter(),n=Math.pow(2,t.getZoom()),a=s.lng()-180*this.canvasCssWidth_/(256*n);this.topLeft_=new google.maps.LatLng(i,a);var o=this.getProjection(),r=o.fromLatLngToDivPixel(s),h=-Math.round(this.canvasCssWidth_/2-r.x),d=-Math.round(this.canvasCssHeight_/2-r.y);this.canvas.style[e.CSS_TRANSFORM_]="translate("+h+"px,"+d+"px)"},e.prototype.update_=function(){this.requestAnimationFrameId_=null,this.isAdded_&&(this.needsResize_&&this.resizeHandler_&&(this.needsResize_=!1,this.resizeHandler_()),this.updateHandler_&&this.updateHandler_())},e.prototype.getTopLeft=function(){return this.topLeft_},e.prototype.scheduleUpdate=function(){this.isAdded_&&!this.requestAnimationFrameId_&&(this.requestAnimationFrameId_=this.requestAnimFrame_.call(window,this.requestUpdateFunction_))},e}